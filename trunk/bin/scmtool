#!/usr/bin/ruby -w

if ARGV.length() == 0
    $stderr.puts("Use the 'checkintool' or 'revisiontool' scripts instead.")
    exit(1)
end

tool_name=ARGV.shift()

require 'fileutils.rb'
require 'pathname.rb'

# Cope with symbolic links to this script.
tools_dir = Pathname.new("#{__FILE__}/..").realpath().dirname()
salma_hayek = "#{tools_dir}/../salma-hayek"

require "#{salma_hayek}/bin/target-os.rb"

class_path = "#{tools_dir}/classes:#{salma_hayek}/classes"
if target_os() != "Darwin"
    class_path = "#{class_path}:#{salma_hayek}/MRJ141Stubs.jar"
end

args = [ "java", "-Xmx1g", "-cp", class_path ]
if target_os() == "Darwin"
    args << "-Xdock:name=#{tool_name}"
end
args << "e.util.Launcher"
args << tool_name
args << "e.scm.#{tool_name}"
args.concat(ARGV)
system(*args)
